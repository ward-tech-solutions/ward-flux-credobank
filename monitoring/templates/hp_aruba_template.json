{
  "name": "HP/Aruba Switch Standard",
  "description": "Standard monitoring template for HP and Aruba switches",
  "vendor": "HP",
  "device_types": ["switch", "l3_switch"],
  "is_default": true,
  "items": [
    {
      "name": "System Description",
      "oid_name": "sysDescr",
      "oid": "1.3.6.1.2.1.1.1.0",
      "interval": 300,
      "value_type": "string",
      "units": "",
      "description": "Switch model and firmware version"
    },
    {
      "name": "System Uptime",
      "oid_name": "sysUpTime",
      "oid": "1.3.6.1.2.1.1.3.0",
      "interval": 60,
      "value_type": "integer",
      "units": "timeticks",
      "description": "Time since last reboot"
    },
    {
      "name": "CPU Utilization",
      "oid_name": "hpSwitchCpuStat",
      "oid": "1.3.6.1.4.1.11.2.14.11.5.1.9.6.1.0",
      "interval": 60,
      "value_type": "gauge",
      "units": "%",
      "description": "Current CPU utilization"
    },
    {
      "name": "Memory Total",
      "oid_name": "hpLocalMemTotalBytes",
      "oid": "1.3.6.1.4.1.11.2.14.11.5.1.1.2.1.1.1.5",
      "interval": 300,
      "value_type": "gauge",
      "units": "bytes",
      "description": "Total memory",
      "is_table": true
    },
    {
      "name": "Memory Free",
      "oid_name": "hpLocalMemFreeBytes",
      "oid": "1.3.6.1.4.1.11.2.14.11.5.1.1.2.1.1.1.6",
      "interval": 60,
      "value_type": "gauge",
      "units": "bytes",
      "description": "Free memory",
      "is_table": true
    },
    {
      "name": "Switch Temperature",
      "oid_name": "hpicfSensorObjectValue",
      "oid": "1.3.6.1.4.1.11.2.14.11.1.2.6.1.4",
      "interval": 120,
      "value_type": "gauge",
      "units": "celsius",
      "description": "Switch temperature sensors",
      "is_table": true
    },
    {
      "name": "Fan Status",
      "oid_name": "hpicfFanState",
      "oid": "1.3.6.1.4.1.11.2.14.11.1.2.6.1.3",
      "interval": 120,
      "value_type": "integer",
      "units": "",
      "description": "Fan operational state (4=running)",
      "is_table": true
    },
    {
      "name": "Power Supply Status",
      "oid_name": "hpicfPsState",
      "oid": "1.3.6.1.4.1.11.2.14.11.1.2.6.1.3",
      "interval": 120,
      "value_type": "integer",
      "units": "",
      "description": "Power supply state (4=running)",
      "is_table": true
    },
    {
      "name": "PoE Port Power",
      "oid_name": "pethPsePortPowerPairsControlAbility",
      "oid": "1.3.6.1.2.1.105.1.1.1.1.1",
      "interval": 60,
      "value_type": "gauge",
      "units": "watts",
      "description": "PoE power per port",
      "is_table": true
    },
    {
      "name": "PoE Port Status",
      "oid_name": "pethPsePortDetectionStatus",
      "oid": "1.3.6.1.2.1.105.1.1.1.1.6",
      "interval": 60,
      "value_type": "integer",
      "units": "",
      "description": "PoE detection status (3=delivering power)",
      "is_table": true
    },
    {
      "name": "Stack Member Status",
      "oid_name": "hpStackMemberState",
      "oid": "1.3.6.1.4.1.11.2.14.11.5.1.10.3.1.1.5",
      "interval": 120,
      "value_type": "integer",
      "units": "",
      "description": "Stack member state (3=active)",
      "is_table": true
    },
    {
      "name": "Interface Status",
      "oid_name": "ifOperStatus",
      "oid": "1.3.6.1.2.1.2.2.1.8",
      "interval": 60,
      "value_type": "integer",
      "units": "",
      "description": "Interface operational status",
      "is_table": true
    },
    {
      "name": "Interface Traffic In",
      "oid_name": "ifHCInOctets",
      "oid": "1.3.6.1.2.1.31.1.1.1.6",
      "interval": 60,
      "value_type": "counter64",
      "units": "bytes",
      "description": "High capacity inbound traffic",
      "is_table": true
    },
    {
      "name": "Interface Traffic Out",
      "oid_name": "ifHCOutOctets",
      "oid": "1.3.6.1.2.1.31.1.1.1.10",
      "interval": 60,
      "value_type": "counter64",
      "units": "bytes",
      "description": "High capacity outbound traffic",
      "is_table": true
    },
    {
      "name": "VLAN Count",
      "oid_name": "dot1qNumVlans",
      "oid": "1.3.6.1.2.1.17.7.1.1.1.0",
      "interval": 300,
      "value_type": "integer",
      "units": "vlans",
      "description": "Total number of VLANs"
    }
  ],
  "triggers": [
    {
      "name": "High CPU Usage",
      "expression": "hpSwitchCpuStat > 85",
      "severity": "warning",
      "for_duration": 300,
      "description": "CPU utilization above 85%"
    },
    {
      "name": "Critical CPU Usage",
      "expression": "hpSwitchCpuStat > 95",
      "severity": "critical",
      "for_duration": 120,
      "description": "CPU utilization above 95%"
    },
    {
      "name": "Low Memory",
      "expression": "(hpLocalMemFreeBytes / hpLocalMemTotalBytes) * 100 < 10",
      "severity": "warning",
      "for_duration": 300,
      "description": "Less than 10% memory available"
    },
    {
      "name": "High Temperature",
      "expression": "hpicfSensorObjectValue > 60",
      "severity": "warning",
      "for_duration": 300,
      "description": "Switch temperature above 60°C"
    },
    {
      "name": "Critical Temperature",
      "expression": "hpicfSensorObjectValue > 70",
      "severity": "critical",
      "for_duration": 60,
      "description": "Switch temperature above 70°C"
    },
    {
      "name": "Fan Failure",
      "expression": "hpicfFanState != 4",
      "severity": "critical",
      "for_duration": 60,
      "description": "Fan is not running"
    },
    {
      "name": "Power Supply Failure",
      "expression": "hpicfPsState != 4",
      "severity": "critical",
      "for_duration": 60,
      "description": "Power supply is not running"
    },
    {
      "name": "PoE Port Overload",
      "expression": "pethPsePortPowerPairsControlAbility > 30",
      "severity": "warning",
      "for_duration": 300,
      "description": "PoE port power above 30W"
    },
    {
      "name": "Stack Member Inactive",
      "expression": "hpStackMemberState != 3",
      "severity": "critical",
      "for_duration": 120,
      "description": "Stack member is not active"
    },
    {
      "name": "Interface Down",
      "expression": "ifOperStatus == 2",
      "severity": "error",
      "for_duration": 60,
      "description": "Interface is operationally down"
    }
  ]
}
