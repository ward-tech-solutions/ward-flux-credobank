{
  "name": "Windows Server Standard",
  "description": "Standard monitoring template for Windows servers with SNMP service",
  "vendor": "Windows",
  "device_types": ["server", "vm", "workstation"],
  "is_default": true,
  "items": [
    {
      "name": "System Description",
      "oid_name": "sysDescr",
      "oid": "1.3.6.1.2.1.1.1.0",
      "interval": 300,
      "value_type": "string",
      "units": "",
      "description": "Windows version and build"
    },
    {
      "name": "System Uptime",
      "oid_name": "sysUpTime",
      "oid": "1.3.6.1.2.1.1.3.0",
      "interval": 60,
      "value_type": "integer",
      "units": "timeticks",
      "description": "Time since last reboot"
    },
    {
      "name": "CPU Processor Time",
      "oid_name": "hrProcessorLoad",
      "oid": "1.3.6.1.2.1.25.3.3.1.2",
      "interval": 60,
      "value_type": "gauge",
      "units": "%",
      "description": "CPU utilization per processor",
      "is_table": true
    },
    {
      "name": "Memory Physical Total",
      "oid_name": "hrMemorySize",
      "oid": "1.3.6.1.2.1.25.2.2.0",
      "interval": 300,
      "value_type": "gauge",
      "units": "KB",
      "description": "Total physical memory"
    },
    {
      "name": "Storage Descriptor",
      "oid_name": "hrStorageDescr",
      "oid": "1.3.6.1.2.1.25.2.3.1.3",
      "interval": 300,
      "value_type": "string",
      "units": "",
      "description": "Storage device descriptions",
      "is_table": true
    },
    {
      "name": "Storage Allocation Units",
      "oid_name": "hrStorageAllocationUnits",
      "oid": "1.3.6.1.2.1.25.2.3.1.4",
      "interval": 300,
      "value_type": "integer",
      "units": "bytes",
      "description": "Storage allocation unit size",
      "is_table": true
    },
    {
      "name": "Storage Size",
      "oid_name": "hrStorageSize",
      "oid": "1.3.6.1.2.1.25.2.3.1.5",
      "interval": 300,
      "value_type": "gauge",
      "units": "units",
      "description": "Total storage size in allocation units",
      "is_table": true
    },
    {
      "name": "Storage Used",
      "oid_name": "hrStorageUsed",
      "oid": "1.3.6.1.2.1.25.2.3.1.6",
      "interval": 60,
      "value_type": "gauge",
      "units": "units",
      "description": "Used storage in allocation units",
      "is_table": true
    },
    {
      "name": "Process Count",
      "oid_name": "hrSystemProcesses",
      "oid": "1.3.6.1.2.1.25.1.6.0",
      "interval": 60,
      "value_type": "gauge",
      "units": "processes",
      "description": "Number of running processes"
    },
    {
      "name": "Running Process Names",
      "oid_name": "hrSWRunName",
      "oid": "1.3.6.1.2.1.25.4.2.1.2",
      "interval": 120,
      "value_type": "string",
      "units": "",
      "description": "Names of running processes",
      "is_table": true
    },
    {
      "name": "Running Process Status",
      "oid_name": "hrSWRunStatus",
      "oid": "1.3.6.1.2.1.25.4.2.1.7",
      "interval": 120,
      "value_type": "integer",
      "units": "",
      "description": "Process status (1=running, 2=runnable)",
      "is_table": true
    },
    {
      "name": "Interface Status",
      "oid_name": "ifOperStatus",
      "oid": "1.3.6.1.2.1.2.2.1.8",
      "interval": 60,
      "value_type": "integer",
      "units": "",
      "description": "Interface operational status",
      "is_table": true
    },
    {
      "name": "Interface Traffic In",
      "oid_name": "ifInOctets",
      "oid": "1.3.6.1.2.1.2.2.1.10",
      "interval": 60,
      "value_type": "counter32",
      "units": "bytes",
      "description": "Inbound traffic per interface",
      "is_table": true
    },
    {
      "name": "Interface Traffic Out",
      "oid_name": "ifOutOctets",
      "oid": "1.3.6.1.2.1.2.2.1.16",
      "interval": 60,
      "value_type": "counter32",
      "units": "bytes",
      "description": "Outbound traffic per interface",
      "is_table": true
    },
    {
      "name": "Service Installed",
      "oid_name": "svSvcInstalledState",
      "oid": "1.3.6.1.4.1.77.1.2.3.1.1",
      "interval": 300,
      "value_type": "integer",
      "units": "",
      "description": "Windows service install state",
      "is_table": true
    },
    {
      "name": "Service Operating State",
      "oid_name": "svSvcOperatingState",
      "oid": "1.3.6.1.4.1.77.1.2.3.1.3",
      "interval": 120,
      "value_type": "integer",
      "units": "",
      "description": "Service state (1=active, 2=continue-pending, 3=pause-pending, 4=paused)",
      "is_table": true
    }
  ],
  "triggers": [
    {
      "name": "High CPU Usage",
      "expression": "avg(hrProcessorLoad) > 85",
      "severity": "warning",
      "for_duration": 300,
      "description": "Average CPU utilization above 85%"
    },
    {
      "name": "Critical CPU Usage",
      "expression": "avg(hrProcessorLoad) > 95",
      "severity": "critical",
      "for_duration": 120,
      "description": "Average CPU utilization above 95%"
    },
    {
      "name": "High Disk Usage",
      "expression": "(hrStorageUsed / hrStorageSize) * 100 > 85",
      "severity": "warning",
      "for_duration": 600,
      "description": "Disk usage above 85%"
    },
    {
      "name": "Critical Disk Usage",
      "expression": "(hrStorageUsed / hrStorageSize) * 100 > 95",
      "severity": "critical",
      "for_duration": 300,
      "description": "Disk usage above 95%"
    },
    {
      "name": "Too Many Processes",
      "expression": "hrSystemProcesses > 500",
      "severity": "warning",
      "for_duration": 300,
      "description": "More than 500 processes running"
    },
    {
      "name": "Critical Process Count",
      "expression": "hrSystemProcesses > 1000",
      "severity": "critical",
      "for_duration": 120,
      "description": "More than 1000 processes running"
    },
    {
      "name": "Service Stopped",
      "expression": "svSvcOperatingState == 4",
      "severity": "error",
      "for_duration": 60,
      "description": "Critical Windows service is stopped"
    },
    {
      "name": "Interface Down",
      "expression": "ifOperStatus == 2",
      "severity": "error",
      "for_duration": 60,
      "description": "Network interface is operationally down"
    }
  ]
}
