# WARD FLUX - System Architecture

## ğŸ“ High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CLIENT LAYER                                â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   Web UI     â”‚  â”‚   Mobile     â”‚  â”‚  API Client  â”‚              â”‚
â”‚  â”‚  (Browser)   â”‚  â”‚    (PWA)     â”‚  â”‚  (Scripts)   â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                  â”‚                  â”‚                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                            â”‚                                         â”‚
â”‚                      HTTPS / WSS                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     API GATEWAY LAYER                                â”‚
â”‚                            â”‚                                         â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                  â”‚  Nginx Reverse    â”‚                              â”‚
â”‚                  â”‚      Proxy        â”‚                              â”‚
â”‚                  â”‚  (SSL/TLS, LB)    â”‚                              â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    APPLICATION LAYER                                 â”‚
â”‚                            â”‚                                         â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚            â”‚     WARD FLUX CORE            â”‚                        â”‚
â”‚            â”‚      (FastAPI)                â”‚                        â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                            â”‚                                         â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚         â”‚                  â”‚                  â”‚                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚    â”‚ Zabbix   â”‚    â”‚ Standalone  â”‚   â”‚   Hybrid    â”‚              â”‚
â”‚    â”‚  Mode    â”‚    â”‚    Mode     â”‚   â”‚    Mode     â”‚              â”‚
â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                  â”‚                  â”‚                     â”‚
â”‚         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚                     â”‚
â”‚         â”‚         â”‚ Monitoring Core â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚                 â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”‚   SNMP    â”‚  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”‚  Poller   â”‚  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”‚   ICMP    â”‚  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”‚  Monitor  â”‚  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”‚   Alert   â”‚  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”‚  Engine   â”‚  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”‚ Discovery â”‚  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚                     â”‚
â”‚         â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚                     â”‚
â”‚         â”‚                  â”‚                  â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                  â”‚                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         â”‚          TASK QUEUE LAYER           â”‚                     â”‚
â”‚         â”‚                  â”‚                  â”‚                     â”‚
â”‚         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚                     â”‚
â”‚         â”‚         â”‚  Celery Workers â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”‚   SNMP     â”‚ â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”‚   Tasks    â”‚ â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”‚   ICMP     â”‚ â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”‚   Tasks    â”‚ â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”‚ Discovery  â”‚ â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â”‚   Tasks    â”‚ â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚                     â”‚
â”‚         â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚                     â”‚
â”‚         â”‚                  â”‚                  â”‚                     â”‚
â”‚         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚                     â”‚
â”‚         â”‚         â”‚  Celery Beat    â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚  (Scheduler)    â”‚         â”‚                     â”‚
â”‚         â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚                     â”‚
â”‚         â”‚                  â”‚                  â”‚                     â”‚
â”‚         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚                     â”‚
â”‚         â”‚         â”‚  Redis Message  â”‚         â”‚                     â”‚
â”‚         â”‚         â”‚     Broker      â”‚         â”‚                     â”‚
â”‚         â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         â”‚           DATA LAYER                 â”‚                     â”‚
â”‚         â”‚                                      â”‚                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚    â”‚ Zabbix   â”‚              â”‚    VictoriaMetrics        â”‚          â”‚
â”‚    â”‚   API    â”‚              â”‚   (Time-Series DB)        â”‚          â”‚
â”‚    â”‚          â”‚              â”‚                           â”‚          â”‚
â”‚    â”‚  â€¢ Hosts â”‚              â”‚  â€¢ SNMP Metrics           â”‚          â”‚
â”‚    â”‚  â€¢ Items â”‚              â”‚  â€¢ ICMP Metrics           â”‚          â”‚
â”‚    â”‚  â€¢ Trigs â”‚              â”‚  â€¢ Interface Stats        â”‚          â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â€¢ Custom Metrics         â”‚          â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                      â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚                  â”‚      PostgreSQL              â”‚                   â”‚
â”‚                  â”‚   (Configuration DB)         â”‚                   â”‚
â”‚                  â”‚                              â”‚                   â”‚
â”‚                  â”‚  â€¢ Users & Auth              â”‚                   â”‚
â”‚                  â”‚  â€¢ Devices                   â”‚                   â”‚
â”‚                  â”‚  â€¢ SNMP Credentials          â”‚                   â”‚
â”‚                  â”‚  â€¢ Monitoring Items          â”‚                   â”‚
â”‚                  â”‚  â€¢ Templates                 â”‚                   â”‚
â”‚                  â”‚  â€¢ Alert Rules               â”‚                   â”‚
â”‚                  â”‚  â€¢ Alert History             â”‚                   â”‚
â”‚                  â”‚  â€¢ Discovery Rules           â”‚                   â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow Diagrams

### Standalone Mode - SNMP Polling Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Celery    â”‚  Every 60s (configurable)
â”‚    Beat     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Trigger
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SNMP Poll Task â”‚
â”‚  (Celery Worker)â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Get device credentials
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PostgreSQL    â”‚
â”‚  SNMPCredential â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 2. Decrypt credentials
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SNMP Poller    â”‚
â”‚  pysnmp-lextudioâ”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. SNMP GET/WALK
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Target Device  â”‚  (Router/Switch/Server)
â”‚   SNMP Agent    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 4. Return values (CPU, Memory, Interfaces)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SNMP Poller    â”‚
â”‚  Parse Response â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 5. Format metrics
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VictoriaMetrics â”‚
â”‚   Write Metrics â”‚
â”‚                 â”‚
â”‚ cpu{device="R1",â”‚
â”‚     ip="1.2.3.4"â”‚
â”‚     } = 45      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 6. Check alert rules
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Alert Engine   â”‚
â”‚  Evaluate Rules â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 7. If threshold exceeded
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Notification   â”‚
â”‚   Email/Webhook â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Standalone Mode - ICMP Monitoring Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Celery    â”‚  Every 30s
â”‚    Beat     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Trigger
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ICMP Ping Task â”‚
â”‚  (Celery Worker)â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Get active devices
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PostgreSQL    â”‚
â”‚     Devices     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 2. Batch devices (100 at a time)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ICMP Monitor   â”‚
â”‚   (icmplib)     â”‚
â”‚                 â”‚
â”‚  Async parallel â”‚
â”‚  ping 100 hosts â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. ICMP Echo Request
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Network Devices â”‚
â”‚  (100 hosts)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 4. ICMP Echo Reply (or timeout)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ICMP Monitor   â”‚
â”‚  Calculate RTT  â”‚
â”‚  Packet Loss    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 5. Write metrics
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VictoriaMetrics â”‚
â”‚                 â”‚
â”‚ ping_rtt_ms{    â”‚
â”‚   device="R1"   â”‚
â”‚ } = 12.5        â”‚
â”‚                 â”‚
â”‚ ping_loss{      â”‚
â”‚   device="R1"   â”‚
â”‚ } = 0           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 6. Check availability
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Alert Engine   â”‚
â”‚  If device down â”‚
â”‚  for 2+ checks  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 7. Send alert
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Notification   â”‚
â”‚   Email/Webhook â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Auto-Discovery Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    User     â”‚
â”‚   Triggers  â”‚
â”‚  Discovery  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ POST /api/v1/monitoring/discovery/scan
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Discovery API  â”‚
â”‚  Create Job     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Enqueue Celery task
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Discovery Task  â”‚
â”‚ (Celery Worker) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. ICMP Sweep (192.168.1.0/24)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ICMP Scanner   â”‚
â”‚  Ping 254 IPs   â”‚
â”‚  in parallel    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 2. Alive hosts (e.g., 50 replied)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SNMP Classifier â”‚
â”‚  Try SNMP on    â”‚
â”‚  each alive IP  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. Get sysDescr (OID 1.3.6.1.2.1.1.1.0)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SNMP Response  â”‚
â”‚  "Cisco IOS..."â”‚
â”‚  "Linux 5.15..."â”‚
â”‚  "Windows..."   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 4. Classify device type
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Classifier     â”‚
â”‚  â€¢ Router       â”‚
â”‚  â€¢ Switch       â”‚
â”‚  â€¢ Server       â”‚
â”‚  â€¢ Unknown      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 5. Save discovery results
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PostgreSQL    â”‚
â”‚ DiscoveryResult â”‚
â”‚                 â”‚
â”‚ ip, hostname,   â”‚
â”‚ device_type,    â”‚
â”‚ sys_descr       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 6. Return to user
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Web UI       â”‚
â”‚  Show discoveredâ”‚
â”‚  devices        â”‚
â”‚  [Add to        â”‚
â”‚   Monitoring]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ›ï¸ Module Structure

```
/app
â”œâ”€â”€ main.py                      # FastAPI application entry
â”œâ”€â”€ database.py                  # SQLAlchemy setup
â”œâ”€â”€ config.py                    # Configuration management
â”‚
â”œâ”€â”€ routers/                     # API endpoints
â”‚   â”œâ”€â”€ auth.py                  # Authentication
â”‚   â”œâ”€â”€ devices.py               # Device management
â”‚   â”œâ”€â”€ diagnostics.py           # Ping/Traceroute/MTR
â”‚   â”œâ”€â”€ reports.py               # Reporting
â”‚   â”œâ”€â”€ monitoring.py            # NEW - Standalone monitoring API
â”‚   â”œâ”€â”€ alerts.py                # NEW - Alert management API
â”‚   â””â”€â”€ discovery.py             # NEW - Discovery API
â”‚
â”œâ”€â”€ monitoring/                  # NEW - Standalone monitoring engine
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ celery_app.py           # Celery configuration
â”‚   â”œâ”€â”€ tasks.py                # Celery tasks
â”‚   â”œâ”€â”€ models.py               # Database models
â”‚   â”‚
â”‚   â”œâ”€â”€ snmp/                   # SNMP Monitoring
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ poller.py           # SNMP GET/WALK operations
â”‚   â”‚   â”œâ”€â”€ oids.py             # OID definitions
â”‚   â”‚   â””â”€â”€ credentials.py      # Credential encryption
â”‚   â”‚
â”‚   â”œâ”€â”€ icmp/                   # ICMP Monitoring
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ monitor.py          # Ping operations
â”‚   â”‚   â””â”€â”€ scheduler.py        # Ping scheduling
â”‚   â”‚
â”‚   â”œâ”€â”€ alerts/                 # Alerting Engine
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ engine.py           # Alert evaluation
â”‚   â”‚   â”œâ”€â”€ notifications.py    # Email/Webhook/SMS
â”‚   â”‚   â””â”€â”€ rules.py            # Rule management
â”‚   â”‚
â”‚   â”œâ”€â”€ discovery/              # Auto-Discovery
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ scanner.py          # ICMP sweep
â”‚   â”‚   â”œâ”€â”€ classifier.py       # Device classification
â”‚   â”‚   â””â”€â”€ rules.py            # Discovery rules
â”‚   â”‚
â”‚   â”œâ”€â”€ templates/              # Monitoring Templates
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ builder.py          # Template CRUD
â”‚   â”‚   â”œâ”€â”€ applier.py          # Apply templates
â”‚   â”‚   â””â”€â”€ defaults/           # Default templates
â”‚   â”‚       â”œâ”€â”€ generic_snmp.json
â”‚   â”‚       â”œâ”€â”€ cisco_ios.json
â”‚   â”‚       â”œâ”€â”€ linux_snmp.json
â”‚   â”‚       â””â”€â”€ windows_snmp.json
â”‚   â”‚
â”‚   â””â”€â”€ victoria/               # VictoriaMetrics integration
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ client.py           # VM client
â”‚       â””â”€â”€ queries.py          # PromQL queries
â”‚
â”œâ”€â”€ models/                     # Database models
â”‚   â”œâ”€â”€ user.py
â”‚   â”œâ”€â”€ device.py
â”‚   â”œâ”€â”€ monitoring.py           # NEW - Monitoring models
â”‚   â”œâ”€â”€ alert.py                # NEW - Alert models
â”‚   â””â”€â”€ discovery.py            # NEW - Discovery models
â”‚
â”œâ”€â”€ services/                   # Business logic
â”‚   â”œâ”€â”€ zabbix_service.py       # Zabbix integration
â”‚   â””â”€â”€ monitoring_service.py   # NEW - Monitoring service
â”‚
â”œâ”€â”€ templates/                  # Jinja2 HTML templates
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ diagnostics.html
â”‚   â”œâ”€â”€ monitoring.html         # NEW - Monitoring UI
â”‚   â””â”€â”€ alerts.html             # NEW - Alerts UI
â”‚
â”œâ”€â”€ static/                     # Static files
â”‚   â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ monitoring.js       # NEW - Monitoring UI
â”‚   â”‚   â””â”€â”€ alerts.js           # NEW - Alerts UI
â”‚   â””â”€â”€ img/
â”‚
â”œâ”€â”€ tests/                      # Test suite
â”‚   â”œâ”€â”€ test_snmp.py           # NEW - SNMP tests
â”‚   â”œâ”€â”€ test_icmp.py           # NEW - ICMP tests
â”‚   â”œâ”€â”€ test_alerts.py         # NEW - Alert tests
â”‚   â””â”€â”€ test_discovery.py      # NEW - Discovery tests
â”‚
â”œâ”€â”€ alembic/                    # Database migrations
â”‚   â””â”€â”€ versions/
â”‚       â””â”€â”€ xxx_add_monitoring_tables.py  # NEW
â”‚
â””â”€â”€ docker-compose.yml          # Updated with Victoria, Redis, Celery
```

---

## ğŸ” Security Architecture

### Credential Encryption

```python
from cryptography.fernet import Fernet

# Encryption key stored in environment variable
ENCRYPTION_KEY = os.getenv("WARD_ENCRYPTION_KEY")
cipher = Fernet(ENCRYPTION_KEY)

# Encrypt SNMP community string
def encrypt_credential(plaintext: str) -> str:
    return cipher.encrypt(plaintext.encode()).decode()

# Decrypt when needed
def decrypt_credential(encrypted: str) -> str:
    return cipher.decrypt(encrypted.encode()).decode()
```

### API Authentication

```
Client Request
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JWT Token      â”‚  Bearer eyJhbGc...
â”‚  Validation     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼ Valid?
     â”Œâ”€â”€â”€â”´â”€â”€â”€â”
    Yes      No
     â”‚        â”‚
     â–¼        â–¼
  Process   401 Unauthorized
  Request
```

### RBAC Model

```
User Roles:
â”œâ”€â”€ Admin
â”‚   â”œâ”€â”€ All permissions
â”‚   â””â”€â”€ Can manage monitoring configuration
â”œâ”€â”€ Manager
â”‚   â”œâ”€â”€ View all devices
â”‚   â”œâ”€â”€ Configure alerts
â”‚   â””â”€â”€ Run diagnostics
â”œâ”€â”€ Technician
â”‚   â”œâ”€â”€ View assigned devices
â”‚   â”œâ”€â”€ Run diagnostics
â”‚   â””â”€â”€ Acknowledge alerts
â””â”€â”€ Viewer
    â””â”€â”€ Read-only access
```

---

## ğŸ“Š Data Models

### Monitoring Configuration

```python
class MonitoringProfile(Base):
    __tablename__ = "monitoring_profiles"

    id = Column(UUID, primary_key=True)
    name = Column(String(100))
    mode = Column(Enum("zabbix", "standalone", "hybrid"))
    is_active = Column(Boolean, default=False)
    created_at = Column(DateTime, default=datetime.utcnow)
```

### SNMP Credential

```python
class SNMPCredential(Base):
    __tablename__ = "snmp_credentials"

    id = Column(UUID, primary_key=True)
    device_id = Column(UUID, ForeignKey("devices.id"))
    version = Column(String(10))  # "v2c" or "v3"

    # v2c
    community_encrypted = Column(Text)

    # v3
    auth_protocol = Column(String(20))  # MD5, SHA
    auth_key_encrypted = Column(Text)
    priv_protocol = Column(String(20))  # DES, AES
    priv_key_encrypted = Column(Text)
```

### Monitoring Item

```python
class MonitoringItem(Base):
    __tablename__ = "monitoring_items"

    id = Column(UUID, primary_key=True)
    device_id = Column(UUID, ForeignKey("devices.id"))
    template_id = Column(UUID, ForeignKey("monitoring_templates.id"))
    name = Column(String(200))
    oid = Column(String(200))
    interval_seconds = Column(Integer, default=60)
    value_type = Column(String(20))  # integer, float, string
    units = Column(String(20))
    enabled = Column(Boolean, default=True)
```

---

## ğŸš€ Deployment Architecture

### Single Instance (Small Scale)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Docker Host                 â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Nginx      â”‚  â”‚ WARD FLUX   â”‚ â”‚
â”‚  â”‚   (Proxy)    â”‚â†’ â”‚   (FastAPI) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Celery       â”‚  â”‚ Celery Beat â”‚ â”‚
â”‚  â”‚ Worker       â”‚  â”‚ (Scheduler) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ PostgreSQL   â”‚  â”‚ Victoria    â”‚ â”‚
â”‚  â”‚              â”‚  â”‚ Metrics     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚   Redis      â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Distributed (Large Scale)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Load Balancer                          â”‚
â”‚                  (HAProxy / Nginx)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                        â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
      â”‚  WARD FLUX  â”‚          â”‚  WARD FLUX  â”‚
      â”‚  Instance 1 â”‚          â”‚  Instance 2 â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
             â”‚                        â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚               â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
â”‚ Celery    â”‚  â”‚ Celery      â”‚  â”‚ Celery  â”‚
â”‚ Worker 1  â”‚  â”‚ Worker 2    â”‚  â”‚ Worker 3â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚               â”‚               â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Redis Cluster â”‚
              â”‚   (Sentinel)   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚               â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚PostgreSQL â”‚  â”‚ Victoria    â”‚  â”‚   Zabbix     â”‚
â”‚  Primary  â”‚  â”‚ Metrics     â”‚  â”‚   (Optional) â”‚
â”‚           â”‚  â”‚  Cluster    â”‚  â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Scalability Considerations

### Horizontal Scaling
- **API Servers:** Add more FastAPI instances behind load balancer
- **Celery Workers:** Scale workers based on queue depth
- **VictoriaMetrics:** Use VM cluster for high write throughput

### Performance Optimization
- **Connection Pooling:** SNMP session pooling
- **Batch Operations:** Poll multiple OIDs in single SNMP request
- **Caching:** Redis cache for frequently accessed data
- **Query Optimization:** Indexed database queries

### Resource Allocation
```
Component          CPU      RAM       Disk
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
WARD FLUX API      2 cores  2GB       10GB
Celery Worker      2 cores  1GB       5GB
VictoriaMetrics    4 cores  4GB       100GB (metrics)
PostgreSQL         2 cores  2GB       50GB
Redis              1 core   512MB     1GB
```

---

## ğŸ”„ Monitoring the Monitor

### Health Checks
- API endpoint: `/api/v1/health`
- Celery worker status
- VictoriaMetrics reachability
- PostgreSQL connection pool

### Metrics to Track
- API response times
- Celery queue depth
- SNMP poll success rate
- ICMP ping success rate
- Alert delivery rate
- Database query performance

---

**Document Version:** 1.0
**Last Updated:** 2025-10-06
**Owner:** g.jalabadze
**Developer:** Claude (Sonnet 4.5)
